{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <meta http-equiv="refresh" content="0; url=https://shelemetev.github.io/Maket/catalog.html" /> -->
    <link rel="icon" href="{% static 'img/Logo.ico' %}" type="image/x-icon">
    <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="{% static 'fonts/stylesheet.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'iconmoon/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/normolize.css' %}">
    <link rel="stylesheet" href="{% static 'css/reset.css' %}">
    <!-- <link rel="stylesheet" href="./node_modules/swiper/swiper-bundle.min.css"> -->
    <!-- <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/meadia.css' %}">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="{% static 'js/header.js' %}" defer=""></script>
    <script src="{% static 'js/imask/Imask.min.js' %}"></script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">

    <title>Aleucos оптовые поставки корейской косметики</title>
</head>
<body class="{% if is_cart_page %}green-body{% endif %}">
    <div class="modal " id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div data-toggle="modal" data-target="#testModal" class="modal-content modal__offer-content">
                <div class="offer__form">
                    <button type="button" class="btn-close offer__modal-btn" data-bs-dismiss="modal" aria-label="Close"></button>
                    <form class="form contactForm" action="">
                        <div class="contacts__form-box">
                            <h2 class="contacts__form-title">Имя</h2>
                            {{ contact_form.name }}
                        </div>
                        <div class="contacts__form-items">
                            <div class="contacts__form-box">
                                <h2 class="contacts__form-title">Телефон</h2>
                                {{ contact_form.phone }}
                            </div>
                            <div class="contacts__form-box">
                                <h2 class="contacts__form-title">Email</h2>
                                {{ contact_form.email }}
                            </div>
                        </div>
                        <div class="contacts__form-box box__marin-top">
                            <h2 class="contacts__form-title">Сообщение</h2>
                            <textarea placeholder="Введите текст сообщения" maxlength="150" class="contacts__form-input contacts__form-textarea"></textarea>
                        </div>
                        <div class="contacts__form-suptext">Нажимая на кнопку “Отправить заявку”, Вы даете согласие на <a class="contacts__form-suptext--link" href="">обработку персональных данных</a> и соглашаетесь с <a class="contacts__form-suptext--link" href="">политикой конфиденциальности.</a></div>
                        <button class="contacts__form-btn section__btn">Оставить заявку</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="toast after-order" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-inner">
            <div class="content">
                <p class="heading">Спасибо за ваш заказ в нашем магазине!</p>
                <p class="text">Мы рады, что вы выбрали именно нас! Ваши товары уже в обработке, и мы сделаем все возможное, чтобы они как можно скорее оказались у вас.</p>
                <div class="points">
                    <div class="point">
                        <img src="{% static 'img/green-star.svg' %}" alt="">
                        <a href="">Уход за телом</a>
                    </div>
                    <div class="point">
                        <img src="{% static 'img/green-star.svg' %}" alt="">
                        <a href="">Уход за кожей лица</a>
                    </div>
                    <div class="point">
                        <img src="{% static 'img/green-star.svg' %}" alt="">
                        <a href="">Уход за волосами</a>
                    </div>
                </div>
            </div>
            <img class="only-desktop" src="{% static 'img/toast-girl.png' %}" alt="">
        </div>
    </div>

    <div class="toast after-request" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-inner">
            <div class="content">
                <p class="heading">Спасибо за Доверие!</p>
                <p class="text">Мы рады, что вы выбрали именно нас! В ближайшее время с вами свяжуться наши спецалисты и проконсультируют вас по всем вопросам.</p>
                <div class="points">
                    <div class="point">
                        <img src="{% static 'img/green-star.svg' %}" alt="">
                        <a href="">Уход за телом</a>
                    </div>
                    <div class="point">
                        <img src="{% static 'img/green-star.svg' %}" alt="">
                        <a href="">Уход за кожей лица</a>
                    </div>
                    <div class="point">
                        <img src="{% static 'img/green-star.svg' %}" alt="">
                        <a href="">Уход за волосами</a>
                    </div>
                </div>
            </div>
            <img class="only-desktop" src="{% static 'img/toast-girl.png' %}" alt="">
        </div>
    </div>

    <header class="header nav-down">
        <div class="container general">
            <div class="row header__inner align-items-center">
                <div class="col header__logo">
                    <a href="/" class="header__logo-link">
                        <img src="{% static 'img/Logo.svg' %}" alt="" class="header__logo-img">
                    </a>
                </div>
                <div class="col-auto header__menu header-desktop">
                    <a href="{% url 'products:products_list' %}" class="header__menu-link hover-green">Каталог</a>
                    <a href="{% url 'contacts:about' %}" class="header__menu-link hover-green">О компании</a>
                    <a href="{% url 'home:home' %}#answersBlock"><button class="header__menu-link hover-green">Вопрос-ответ</button></a>
                    <a href="{% url 'contacts:contacts' %}"><button class="header__menu-link hover-green">Контакты</button></a>
                </div>
                <div class="col-auto header__service">
                    <div class="row header__service-box">
                        <div class="col padding-0">
                            <button class="header__request-button header-desktop" data-toggle="modal" data-target="#exampleModal" data-bs-toggle="modal" data-bs-target="#exampleModal">Оставить заявку</button>
                        </div>
                        <div class="col header__service-links">
                            {% if request.path == '/users/account/' %}
                                <button class="header__service-link">
                                    <a href="{% if request.user.is_authenticated %}{% url 'users:account' %}{% else %}{% url 'users:login' %}{% endif %}"><img src="{% static 'img/person.svg' %}" alt="" class="header__service-img"></a>
                                </button>
                                    <form class="header__service-link" action="{% url 'users:logout' %}" method="post">
                                        {% csrf_token %}
                                        <button type="submit" href="{% url 'users:logout' %}"><img src="{% static 'img/logout-icon.svg' %}" alt="" class="header__service-img"></button>
                                    </form>
                            {% else %}
                                <button class="header__service-link">
                                    <a href="{% if request.user.is_authenticated %}{% url 'users:account' %}{% else %}{% url 'users:login' %}{% endif %}"><img src="{% static 'img/person.svg' %}" alt="" class="header__service-img"></a>
                                </button>
                                <button class="header__service-link header__cart-icon">
                                    <a href="{% if request.user.is_authenticated %}{% url 'carts:cart_items' %}{% else %}{% url 'users:login' %}{% endif %}"><img src="{% static 'img/store.svg' %}" alt="" class="header__service-img header__cart-icon"></a>
                                    {% if request.user.is_authenticated %}
                                        <span id="cartPositionsCount" class="cart-badge {% if not cart_positions_count %}display-none{% endif %}">
                                            {% if cart_positions_count %}{{ cart_positions_count }}{% else %}0{% endif %}
                                        </span>
                                    {% endif %}
                                </button>
                            {% endif %}
                            <form id="searchForm" action="{% url 'products:products_list' %}" method="get">
                                <input id="searchInput" name="q" class="header__service-input {% if search_text %}active{% endif %}" placeholder="Поиск" {% if search_text %}value="{{ search_text }}"{% endif %} type="text">
                            </form>
                            <button id="openSearchInput" class="header__service-link">
                                <img src="{% if search_text %}{% static 'img/close-search-button.svg' %}{% else %}{% static 'img/black-search-icon.svg' %}{% endif %}" 
                                    data-close-img="{% static 'img/close-search-button.svg' %}"
                                    data-open-img="{% static 'img/black-search-icon.svg' %}" 
                                    alt="" 
                                    class="header__service-img"
                                >
                            </button>
                            <div class="dropdown dropdown__header">
                                <button class="btn btn-secondary dropdown-toggle header__menu-btn" onclick="openMobileMenu()" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <img src="{% static 'img/open-menu.svg' %}" alt="">
                                </button>
                                <ul class="dropdown-menu dropdown__header-menu" style="inset: auto auto auto 0;">
                                    <li><button href="{% url 'products:products_list' %}" class="header__menu-link dropdown-item">Каталог</button></li>
                                    <li><button href="{% url 'home:home' %}#answersBlock" class="header__menu-link dropdown-item">Вопрос</button></li>
                                    <li><button href="{% url 'contacts:contacts' %}" class="header__menu-link dropdown-item">Контакты</button></li>
                                </ul>
                            </div>
                            <div class="header-mobile-menu">
                                <div class="mobile-menu-points">
                                    <a href="{% url 'products:products_list' %}" class="mobile-menu-point hover-green">Каталог</a>
                                    <a href="{% url 'contacts:about' %}" class="mobile-menu-point hover-green">О компании</a>
                                    <a href="{% url 'home:home' %}#answersBlock"><button class="mobile-menu-point hover-green">Вопрос-ответ</button></a>
                                    <a href="{% url 'contacts:contacts' %}"><button class="mobile-menu-point hover-green">Контакты</button></a>
                                    <a href="{% url 'users:account' %}"><button class="mobile-menu-point hover-green">Личный кабинет</button></a>
                                    <div class="leave-request-header-mobile">Оставить заявку</div>
                                    <div class="contacts__contact-info-phone">
                                        <p>+7 (964) 454-17-00</p>
                                        <div class="footer__messagers">
                                            <div class="col-auto">
                                                <a href="tel:+79644541700" class="footer__link">
                                                    <img src="/static/img/Whatsapp.svg" alt="" class="footer__link-img">
                                                </a>
                                            </div>
                                            <div class="col-auto">
                                                <a href="https://www.instagram.com/@aleucos.vl" class="footer__link">
                                                    <img src="/static/img/telegram.svg" alt="" class="footer__link-img">
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>  
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">

        {% if messages %}
            <div class="alert-container">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }} 
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div> 
                {% endfor %}
            </div>
        {% endif %}
        
        {% block content %}
        {% endblock %}
    </div>

    {% block script %}{% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <footer class="footer">
        <div class="container px-4">
            <div class="footer__inner">
                <div class="row">
                    <div class="col-auto">
                        <a href="{% url 'home:home' %}" class="footer__text">@2025 Aleucos</a>
                    </div>
                    <div class="col">
                        <div class="row footer__menu justify-content-md-center">
                            <div class="col-auto">
                                <a href="{% url 'products:products_list' %}"><p class="footer__text">Каталог</p></a>
                            </div>
                            <div class="col-auto">
                                <a href="#answersBlock"><p class="footer__text">Вопрос-ответ</p></a>
                            </div>
                            <div class="col-auto">
                                <a href="#contactsBlock"><p class="footer__text">Контакты</p></a>
                            </div>
                            <div class="col-auto">
                                <a href=""><p class="footer__text">Политика конфиденциальности</p></a>
                            </div>
                        </div>
                    </div>
                    <div class="col-auto">
                        <div class="footer__messagers">
                            <div class="col-auto">
                                <a href="tel:+79644541700" class="footer__link">
                                    <img src="{% static 'img/Whatsapp.svg' %}" alt="" class="footer__link-img">
                                </a>
                            </div>
                            <div class="col-auto">
                                <a href="https://www.instagram.com/@aleucos.vl" class="footer__link">
                                    <img src="{% static 'img/telegram.svg' %}" alt="" class="footer__link-img">
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- <script src="./node_modules/swiper/swiper-bundle.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cleave.js/1.6.0/cleave.js" integrity="sha512-BjE6jVr0CP6MHwhQDktnlrSZsenyvbFgyBatZDZIvaNH9hiCVeyeh4vm0CR2JKLvNYGBPKpQQhAhr6hj6Fd4Ug==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <script src="./node_modules/cleave.js/dist/cleave.min.js"></script> -->
    <!-- <script src="./node_modules/cleave.js/dist/addons/cleave-phone.ru.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cleave.js/1.6.0/addons/cleave-phone.ru.js" integrity="sha512-dSXSpCsgx+mWGZjelEzcJtb+fMB8NBepOd7oy2hy5DU4Fj4wX5SclVjdOR3lztHDN8AGUn2zwNq/XLF7T64DwA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        var swiper = new Swiper(".mySwiper-1", {
            // slidesPerView: 'auto',
            // loop: true,
            // spaceBetween: 52,
            // autoplay: {
            //     delay: 1000,
            //     disableOnInteraction: true,
            // },
            // speed: 1000,
            // lazy: true
            freeMode: true,
            spaceBetween: 52,
            slidesPerView: 'auto',
            loop: true,
            autoplay: {
                delay: 0,
                disableOnInteraction: false
            },
            speed: 3000,
        });
        window.addEventListener('resize', () => {
            const viewport_width = Math.max(document.documentElement.clientWidth,window.innerWidth || 0)
            console.log(viewport_width);
            let swiper
            if (viewport_width > 1400) {
                swiper = new Swiper(".mySwiper-2", {
                    slidesPerView:4,
                    spaceBetween: 24,
                    navigation: {
                        nextEl: ".swiper-button-next",
                        prevEl: ".swiper-button-prev",
                    }, 
                });
            } else if (viewport_width <= 1400 && viewport_width >= 768) {
                swiper = new Swiper(".mySwiper-2", {
                    slidesPerView: 2,
                    spaceBetween: 24,
                    freeMode: true,
                });
            } else if (viewport_width < 768) {
                console.log('d');
                swiper = new Swiper(".mySwiper-2", {
                    slidesPerView: 1,
                    spaceBetween: 24,
                    freeMode: false,
                });
            }
        })
        window.addEventListener('DOMContentLoaded', () => {
            const viewport_width = Math.max(document.documentElement.clientWidth,window.innerWidth || 0)
            console.log(viewport_width);
            let swiper
            if (viewport_width > 1400) {
                swiper = new Swiper(".mySwiper-2", {
                    slidesPerView:4,
                    spaceBetween: 24,
                    navigation: {
                        nextEl: ".swiper-button-next",
                        prevEl: ".swiper-button-prev",
                    },  
                    loop:true
                });
            } else if (viewport_width <= 1400 && viewport_width >= 768) {
                swiper = new Swiper(".mySwiper-2", {
                    slidesPerView: 2,
                    spaceBetween: 24,
                    freeMode: true,
                    loop:true, 
                    navigation: {
                        nextEl: ".swiper-button-next",
                        prevEl: ".swiper-button-prev",
                    },
                });
            } else if (viewport_width < 768) {
                console.log('d');
                swiper = new Swiper(".mySwiper-2", {
                    slidesPerView: 1,
                    spaceBetween: 24,
                    freeMode: false,
                    loop:true,
                    navigation: {
                        nextEl: ".swiper-button-next",
                        prevEl: ".swiper-button-prev",
                    },
                });
            }
        })
    </script>

<!-- Маски -->
<script defer>
    document.addEventListener('DOMContentLoaded', () => {
        
        document.querySelectorAll('input[type="tel"]').forEach(input => {
            let phoneMask = IMask(input, { mask: "+{7} (900) 000-00-00" });
    
            function validatePhoneNumber() {
                let t = input.value.replace(/\D/g, "");
                return t.length < 11 ? (input.setCustomValidity("Необходимо минимум 11 цифр"), !1) : (input.setCustomValidity(""), !0);
            }
    
            input.addEventListener("input", validatePhoneNumber);
        });
    });
</script>

<!-- Поиск -->
    <script defer>
        document.addEventListener('DOMContentLoaded', function () {
            let openSearchButton = document.getElementById('openSearchInput'); 
            let searchInput = document.getElementById('searchInput')
            openSearchButton.addEventListener('click', () => {
                let image = openSearchButton.querySelector('img');
                searchInput.classList.toggle('active');
                if (new URL(image.src).pathname == image.dataset.openImg) {
                    image.src = image.dataset.closeImg;
                    searchInput.focus();
                } else {
                    image.src = image.dataset.openImg;
                    searchInput.blur();
                    searchInput.value = "";
                }
            });
        })
        // Увеличивает или уменьшает количество позиций в корзине в хедере около иконки
        function renderCartPositionsCount(increase) {
            let cartPositionElement = document.getElementById('cartPositionsCount'); 
            let cartPositionCount = cartPositionElement.innerHTML;
            if (increase) {
                cartPositionElement.classList.remove('display-none');
                cartPositionCount++;
            } else {
                cartPositionCount--; 
                if (cartPositionCount < 1) {
                    cartPositionCount = 0;
                    cartPositionElement.classList.add('display-none');
                }
            }
            cartPositionElement.innerHTML = cartPositionCount;
        }
    </script>

<!-- Форма ОС в блоке "Оставьте заявку" -->
<script>
    const forms = document.querySelectorAll(".contactForm");
    console.log(forms);
    const closeButton = document.querySelector(".btn-close.offer__modal-btn");
    const toast = new bootstrap.Toast(document.querySelector(".toast.after-request"));
    
    forms.forEach((form) => {
        form.addEventListener("submit", async function (event) {
            event.preventDefault();
            let formData = new FormData(form);
            closeButton.click();
            if (isRootUrl()) {
            } else {
                toast.show();
            }
            form.reset();
            try {
                let response = await fetch(`${window.origin}/api/save_registration_request/`, {
                    method: "POST",
                    body: formData,
                });
                console.log("Статус ответа:", response.status);
            } catch (error) {
                console.error("Ошибка запроса:", error);
            }
        });
    });
    
    </script>

<script>
    function isRootUrl() {
        return window.location.pathname === "/";
    }
    document.addEventListener("DOMContentLoaded", function () {
        if (isRootUrl()) {
            console.log('qqq')
        } else {
            console.log('fff')
        }
        const form = document.getElementById("contactForm");
        const toast = new bootstrap.Toast(document.querySelector(".toast.after-request"));
        // toast.show();
        const closeButton = document.querySelector('.btn-close.offer__modal-btn');

        form.addEventListener("submit", function (event) {
            event.preventDefault(); 

            if (isRootUrl()) {
                console.log('Это домашняя страница'); 
            } else {
                toast.show(); 
            }
            form.reset(); 

            fetch(form.action, {
                method: "POST",
                body: new FormData(form),
            })
            .then(response => response.json())
            .then(data => {
            })
            .catch(error => console.error("Ошибка:", error));
        });
    });
</script>

    <script defer>
        const openMenuButtonUrl = '/static/img/open-menu.svg';
        const closeMenuButtonUrl = '/static/img/close.svg';

        function openMobileMenu() {
            const menuButton = document.querySelector('.header__menu-btn'); 
            const mobileMenu = document.querySelector('.header-mobile-menu');
            const closeButton = document.querySelector('.close-mobile-menu');
            menuButton.classList.add('close-mobile-menu');

            menuButton.removeEventListener('click', openMobileMenu);
            menuButton.addEventListener('click', closeMobileMenu);
            menuButton.querySelector('img').src = closeMenuButtonUrl;

            mobileMenu.classList.add('active');

            window.removeEventListener('scroll', onScroll);  
        }
        function closeMobileMenu() {
            const menuButton = document.querySelector('.header__menu-btn'); 
            const mobileMenu = document.querySelector('.header-mobile-menu');
            const closeButton = document.querySelector('.close-mobile-menu');

            menuButton.removeEventListener('click', closeMobileMenu);
            menuButton.addEventListener('click', openMobileMenu);
            menuButton.querySelector('img').src = openMenuButtonUrl;

            mobileMenu.classList.remove('active');

            window.addEventListener('scroll', onScroll);  
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- <script src="./node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script> -->
    <script src="{% static 'js/script.js' %}"></script>
</body>
</html>